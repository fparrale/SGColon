import{Pa as c,_a as i,e as l,t as s,w as a,z as u}from"./chunk-LKTHQ3NI.js";var p=class r{constructor(t){this.http=t;this.apiUrl=i.apiBaseUrl}apiUrl;tokenSubject=new l(localStorage.getItem("token"));token$=this.tokenSubject.asObservable();login(t,e){let o={email:t,password:e};return this.http.post(`${this.apiUrl}${i.apiEndpoints.auth.login}`,o).pipe(s(n=>{n.ok&&n.token&&(localStorage.setItem("token",n.token),this.tokenSubject.next(n.token))}))}setToken(t){localStorage.setItem("token",t),this.tokenSubject.next(t)}logout(){localStorage.removeItem("token"),this.tokenSubject.next(null)}getToken(){let t=localStorage.getItem("token");return t!==this.tokenSubject.value&&this.tokenSubject.next(t),t}isAuthenticated(){return!!this.getToken()}getCurrentUser(){let t=this.getToken();if(!t)return null;try{let e=t.split(".")[1],o=JSON.parse(atob(e));return{id:o.id,email:o.email,role:o.role}}catch(e){return console.error("Error decodificando token JWT:",e),null}}getCurrentUserRole(){return this.getCurrentUser()?.role??null}isSuperAdmin(){return this.getCurrentUserRole()==="superadmin"}static \u0275fac=function(e){return new(e||r)(u(c))};static \u0275prov=a({token:r,factory:r.\u0275fac,providedIn:"root"})};export{p as a};
