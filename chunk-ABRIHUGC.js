import{b as d}from"./chunk-CTDK6JPT.js";import{Pa as c,T as l,_a as u,g as i,j as s,n as g,w as p,z as o}from"./chunk-LKTHQ3NI.js";var L=class n{constructor(e,a){this.translate=e;this.http=a;this.initializeLanguage()}STORAGE_KEY="sg_ia_language";DEFAULT_LANGUAGE="es";currentLanguage=l(this.DEFAULT_LANGUAGE);availableLanguages=[{code:"es",nameKey:"common.spanish",flag:"\u{1F1EA}\u{1F1F8}"},{code:"en",nameKey:"common.english",flag:"\u{1F1FA}\u{1F1F8}"}];getTranslatedLanguages(){return this.availableLanguages.map(e=>({code:e.code,name:this.translate.instant(e.nameKey),flag:e.flag}))}initializeLanguage(){let e=localStorage.getItem(this.STORAGE_KEY),a=e&&this.isValidLanguage(e)?e:this.DEFAULT_LANGUAGE;this.translate.setFallbackLang(this.DEFAULT_LANGUAGE),this.setLanguage(a)}setLanguage(e,a,t){this.isValidLanguage(e)||(e=this.DEFAULT_LANGUAGE),this.translate.use(e),this.currentLanguage.set(e),localStorage.setItem(this.STORAGE_KEY,e),a&&t&&this.setUserPreference(a,t,e).subscribe({next:()=>{},error:r=>console.error("Failed to sync language preference:",r)})}setLanguageForRoom(e){this.isValidLanguage(e)||(e=this.DEFAULT_LANGUAGE),this.translate.use(e),this.currentLanguage.set(e)}getCurrentLanguage(){return this.currentLanguage()}isValidLanguage(e){return["es","en"].includes(e)}getLanguageName(e){let a=this.availableLanguages.find(t=>t.code===e);return a?this.translate.instant(a.nameKey):e}getUserPreference(e,a){let t=`${u.apiBaseUrl}/preferences/${e}/${a}`;return this.http.get(t).pipe(s(r=>({language:r.language})),g(r=>(console.warn("Failed to get user preference, using default:",r),i({language:"es"}))))}setUserPreference(e,a,t){let r=`${u.apiBaseUrl}/preferences/${e}/${a}/language`;return this.http.put(r,{language:t}).pipe(s(()=>{}),g(m=>(console.error("Failed to save language preference:",m),i(void 0))))}static \u0275fac=function(a){return new(a||n)(o(d),o(c))};static \u0275prov=p({token:n,factory:n.\u0275fac,providedIn:"root"})};export{L as a};
